<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="/css/styles.css"/>
  </head>
  <body>
    <header>
      <nav>
        <ol class="logo">
          <li>
            <a href="/">
              <img src="/media/brightdigit-name.svg"/>
            </a>
          </li>
        </ol>
        <ol class="menu">
          <li>
            <a href="/services">Services</a>
          </li>
          <li>
            <a href="/products">Products</a>
          </li>
          <li>
            <a href="/articles">Articles</a>
          </li>
          <li>
            <a href="/development">Development</a>
          </li>
        </ol>
        <ol class="menu">
          <li>
            <a href="/podcast">Podcast</a>
          </li>
          <li>
            <a href="/newsletters">Newsletters</a>
          </li>
          <li>
            <a href="/sponsorship">Sponsorship</a>
          </li>
          <li>
            <a href="/about">About</a>
          </li>
        </ol>
        <ol class="more">
          <li>
            <a href="/#menu">Menu</a>
          </li>
        </ol>
      </nav>
    </header>
    <main>
      <article>
        <div class="content"><p>Swift packages offer an easy manageable way to share code and functionality. If you wish to create your own package, it's important to make sure your code works where it's supposed to and the quality is good. Most importantly, continuous integration is a great way to ensure that. If you are interested in learning why continuous integration is important, <a href="https://brightdigit.com/blog/2020/03/02/ios-continuous-integration-avoid-merge-hell/">check out this article on avoiding <em>merge hell</em></a>. Therefore, in this article I am going to show you how to setup Swift package continuous integration.</p><p>Specifically, I am going to break down the following:</p><ul><li><strong><a href="#getting-started">Basics of Creating a Package</a></strong></li><li><a href="#specifying-platforms-devices"><strong>Designating Platforms and Operating Systems</strong></a></li><li><a href="#continuous-integration"><strong>Setting Up Travis-CI and GitHub Actions</strong></a></li><li><strong><a href="#linux-ci">Adding Linux Support</a></strong></li><li><a href="#testing"><strong>Testing and Code Coverage</strong></a></li><li><strong><a href="#code-quality">Linting, Formatting, and Code Quality</a></strong></li><li><strong><a href="#documentation">Automating Code Documentation</a></strong></li><li><strong><a href="#distrbuting">Distributing and Sharing</a></strong></li><li><strong><a href="#examples-integration">Samples and Examples</a></strong></li></ul><p>What's important to realize is that Swift packages are reusable pieces of code which encapsulate a set of functionality. In the end, there are two ways to create a Swift package: via <em>Xcode</em> or command line.</p><h2>Getting Started</h2><p>Under the Xcode menu, go to <code>File &gt; New &gt; Swift Package</code> and follow the corresponding dialog. Alternatively, you can use the swift command line tool to create your package. First, create an empty directory and run the create package subcommand:</p><pre><code>&gt; mkdir <span class="type">New</span>-<span class="type">Package</span>
&gt; swift package <span class="keyword">init</span>
</code></pre><p>In the end, you should have:</p><ul><li>A <em>Source</em> directory for your main source code</li><li>A <em>Tests</em> directory for your testing code</li><li>A <em>Package.swift</em> containing the configuration in Swift of your code</li></ul><h2>Specifying Platforms and Devices {#specifying-platforms-devices}</h2><img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2020/03/platforms-and-devices.png"/><p>{.wp-image-871 width="1864" height="878"}</p><p>Before distributing your Swift package, it's important to note which operating systems or platforms your code can run on. In the past I've reasonably assumed a Swift package would work on watchOS or Linux for instance. Only after adding the dependency and attempting to compile, did I realize the incompatibility issue. If you use an API that is limited to certain platforms, you have two options.</p><h3>Specify via Package</h3><p>Firstly, you can specify an operating system and version in the</p><p><code>Package.swift</code> under the <code>platforms</code> property:</p><pre><code>...
  platforms: [
        .<span class="call">macOS</span>(.<span class="dotAccess">v10_15</span>),
        .<span class="call">iOS</span>(.<span class="dotAccess">v13</span>),
        .<span class="call">watchOS</span>(.<span class="dotAccess">v5</span>),
        .<span class="call">tvOS</span>(.<span class="dotAccess">v13</span>)
    ]
...
</code></pre><h3>Using Attributes and API Availability</h3><p>On the other hand, you may want to offer some functionality on some devices. With this in mind, you can use the attributes and API availability checks. In other words the <code>available</code> attribute allows you to mark certain functionality of your Swift package unavailable on certain operating systems and versions.</p><p>In addition, by doing API availability checks you can supply the correct implementation based on operating system and version. Furthermore, whenever you may need to import certain frameworks which may be required but may not be available, you can use <code>canImport</code>, as well.</p><p>Here's an example of extending <code>CGFloat</code> for all operating systems, but importing <code>CoreGraphics</code>, when possible:</p><pre><code><span class="preprocessing">#if canImport(CoreGraphics)</span>
  <span class="keyword">import</span> CoreGraphics
<span class="preprocessing">#endif</span>

<span class="keyword">extension</span> <span class="type">CGFloat</span> {
  <span class="keyword">var</span> clean: <span class="type">String</span> {
    <span class="call">truncatingRemainder</span>(dividingBy: <span class="number">1</span>) == <span class="number">0</span> ? <span class="type">String</span>(format: <span class="string">"%.0f"</span>, <span class="keyword">self</span>) : description
  }
}
</code></pre><hr><p>Be that as it may, if you are planning on supporting all operating systems which support Swift then there is no need to do this. Regardless, it may be worth spending some time verifying and updating this property accordingly.</p><h2>Why Continuous Integration? {#continuous-integration}</h2><p>Having properly setup your package and provided correct compatibility, it's important to make sure your package works. Additionally, you may want to make sure each change to your code works correctly. Luckily, this is where Continuous Integration comes in.</p><p>Continuous integration (CI) is the software practice where small code changes are frequently tested with the rest of the code to ensure nothing breaks as it changes. In other words, with CI we can make sure each change works correctly by integrating a service with our code.</p><p>::: {.iframe} ::: {#embed-app episodes="[{"id":108177,"title":"Continuous Integration with Kyle Newsome","episode<em>type":"full","number":24,"season":1,"formatted</em>published<em>at":"October 13, 2019","duration":2452,"duration</em>in<em>minutes":41,"duration</em>in<em>mmss":"40:52","trackable</em>media<em>url":"https://pdcn.co/e/media.transistor.fm/a14f868f/dfe1727b.mp3","share</em>url":"https://share.transistor.fm/s/a14f868f","transcript<em>url":null,"artwork":"https://images.transistor.fm/file/transistor/images/show/122/thumb</em>1533929410-artwork.jpg","author":"Leo Dion, Principal CEO and Swift Developer at BrightDigit ","formatted<em>summary":"In this episode we talk with Kyle Newsome about continuous integration with iOS and other Apple platforms development.","embed</em>html":"u003ciframe width="100%" height="180" frameborder="no" scrolling="no" seamless src="https://share.transistor.fm/e/a14f868f"u003eu003c/iframeu003e"}]" show="{"id":122,"title":"Empower Apps","website":"https://www.empowerapps.show","multiple<em>seasons":false,"playlist</em>limit":7,"feed<em>url":"https://feeds.transistor.fm/empowerapps-show","private</em>feed":false,"disable<em>feed":false,"disable</em>downloads":false,"apple<em>podcasts</em>url":"https://itunes.apple.com/us/podcast/empower-apps/id1437435392?mt=2","spotify":"https://open.spotify.com/show/0TGuZyeXPPyxYe1JApM6Z5","overcast":"https://overcast.fm/itunes1437435392/empower-apps","stitcher":"https://www.stitcher.com/s?fid=240018u0026refid=stpr","pocket<em>casts":"https://pca.st/9n7e","castro":"https://castro.fm/itunes/1437435392","podcast</em>addict":"https://podcastaddict.com/podcast/2393954","deezer":"","google<em>podcasts":"https://www.google.com/podcasts?feed=aHR0cHM6Ly9mZWVkcy50cmFuc2lzdG9yLmZtL2VtcG93ZXJhcHBzLXNob3c%3D","radioPublic":"https://radiopublic.com/empower-apps-WezKN2","breaker":"https://www.breaker.audio/empower-apps","tuneIn":"http://tun.in/pjaZJ","castbox":"https://castbox.fm/ch/1453575","pandora":"https://www.pandora.com/podcast/empower-apps/PC:21228","iHeartRadio":"https://iheart.com/podcast/78369923/","soundcloud":"","amazon</em>music":"https://music.amazon.com/podcasts/0e053161-686d-47e6-91a1-31d55b121423/Empower-Apps","player_FM":"https://player.fm/series/empower-apps"}"} ::: {#embed-player .player-large .player-light :class="{ 'player-playlist': isPlaylist }" aria-label="Audio Player for Empower Apps" tabindex="1"} ::: {.player-main} ::: {.player-artwork tabindex="-1"} []{.play-btn .icon-play-circle v-show="!playing" title="Play" aria-hidden="true" focusable="false"} []{.pause-btn .icon-pause-circle v-show="playing" title="Pause" aria-hidden="true" focusable="false"}</p><p>::: {.loader-ring v-show="loading"} ::: :::</p><p>::: {.player} ::: {.playback-progress} ::: {.currently-playing} ::: {.show-title} <strong>{{ show.title }}</strong> â€¢ [Trailer]{v-if="selectedEpisode.episode<em>type === 'trailer'"} [Bonus]{v-if="selectedEpisode.episode</em>type === 'bonus'"} [Episode {{ selectedEpisode.number }}]{v-if="selectedEpisode.number"} â€¢ Season {{ selectedEpisode.season }} :::</p><p>::: {.title} {{ selectedEpisode.title }} ::: :::</p><p>::: {.play-progress} []{.play-btn .icon-play-circle v-show="!playing" title="Play" aria-hidden="true" focusable="false"} []{.pause-btn .icon-pause-circle v-show="playing" title="Pause" aria-hidden="true" focusable="false"}</p><p>::: {.loader-ring v-show="loading"} :::</p><p>::: {#progressBar title="Seek" @click="seekTo" aria-label="Seek within Episode"} []{#progress :style="{ left: '-'+ progressBar + '%' }"} ::: :::</p><p>::: {.playback-controls} ::: {.playback-duration} {{ currentTimer }}|{{ currentDuration }} :::</p><p>::: {.volume-speed-controls} {{ displaySpeed }}x ::: ::: :::</p><p>[Subscribe]{#subscribeBtn} [Share]{#shareBtn} [More Info]{#infoBtn} :::</p><p>::: {.subscribe .panel :class="{ expanded: expandedPanel === 'subscribe' }"} []{.close-btn .icon-cancel-circle @click.prevent="closePanel"}</p><p>::: {.title} Subscribe :::</p><p>::: {.copyable-input v-if="!show.private<em>feed &amp;&amp; !show.disable</em>feed"} RSS Feed []{.copy-btn .icon-copy v-clipboard:copy="feed_url" v-clipboard:success="onCopy" title="Copy to clipboard" aria-label="Copy RSS Feed URL to clipboard"} :::</p><p>::: {.social-links} Apple Podcasts Google Podcasts Spotify Pocket Casts Overcast Castro Amazon Music Breaker Stitcher RadioPublic Pandora CastBox iHeartRadio TuneIn Player FM SoundCloud Deezer Podcast Addict ::: :::</p><p>::: {.sharing .panel :class="{ expanded: expandedPanel === 'sharing' }"} []{.close-btn .icon-cancel-circle @click.prevent="closePanel"}</p><p>::: {.title} Share :::</p><p>::: {.copyable-input} Embed []{.copy-btn .icon-copy v-clipboard:copy="embed_html" v-clipboard:success="onCopy" title="Copy to clipboard" aria-label="Copy Embed code to clipboard"} :::</p><p>::: {.copyable-input v-if="!show.private<em>feed"} Share []{.copy-btn .icon-copy v-clipboard:copy="share</em>url" v-clipboard:success="onCopy" title="Copy to clipboard" aria-label="Copy Share URL to clipboard"} :::</p><p>::: {.share-links} []{.twitter .icon-twitter-circle} []{.facebook .icon-facebook-circle} []{.download .icon-download-circle} ::: :::</p><p>::: {.details .panel :class="{ expanded: expandedPanel === 'more' }"} []{.close-btn .icon-cancel-circle @click.prevent="closePanel"} <strong>{{ selectedEpisode.formatted<em>published</em>at }}</strong> â€¢ [Trailer]{v-if="selectedEpisode.episode<em>type === 'trailer'"} [Bonus]{v-if="selectedEpisode.episode</em>type === 'bonus'"} [Episode {{ selectedEpisode.number }}]{v-if="selectedEpisode.number"} â€¢ Season {{ selectedEpisode.season }}</p><p>::: {.details-title} {{ selectedEpisode.title }} :::</p><p>::: {.details-author} By {{ selectedEpisode.author }} â€¢ Full Transcript â€¢ View the Website :::</p><p>::: {.details-summary v-html="selectedEpisode.formatted_summary"} ::: :::</p><p>[ <a href="https://transistor.fm "Broadcast by Transistor.fm""><strong>Broadcast by</strong> <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNTQ3cHgiIGhlaWdodD0iMTQ0cHgiIHZpZXdib3g9IjAgMCA1NDcgMTQ0IiB2ZXJzaW9uPSIxLjEiIGNsYXNzPSJ0cmFuc2lzdG9yLWxvZ28iPgogICAgPGRlZnM+PC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9InRyYW5zaXN0b3JfaG9yaXpvbnRhbCIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSIjRkZGRkZGIj4KICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTEuMDAwMDAwLCA0Mi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgcG9pbnRzPSIwLjcgMTAuNCAwLjcgMS44IDM4LjYgMS44IDM4LjYgMTAuNCAyNC41IDEwLjQgMjQuNSA1OC4zIDE0LjcgNTguMyAxNC43IDEwLjQiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02My4zLDI2LjIgQzYyLjEsMjYgNjAuNywyNS44IDU4LjcsMjUuOCBDNTIuNCwyNS44IDQ4LjcsMjkuOSA0OC43LDM4LjIgTDQ4LjcsNTguMiBMMzkuNCw1OC4yIEwzOS40LDE4LjYgTDQ4LjUsMTguNiBMNDguNSwyNC4yIEw0OC43LDI0LjIgQzUwLjUsMjAuOCA1NC41LDE3LjMgNTkuOCwxNy4zIEM2MS4zLDE3LjMgNjIuMywxNy40IDYzLjMsMTcuNSBMNjMuMywyNi4yIEw2My4zLDI2LjIgWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTA3LjgsNTguMiBMOTguOCw1OC4yIEw5OC44LDUzLjIgTDk4LjYsNTMuMiBDOTUuOSw1Ni42IDkxLjYsNTkuNyA4NSw1OS43IEM3Ni4xLDU5LjcgNjYsNTIuNiA2NiwzOC40IEM2NiwyNS44IDc0LjksMTcuNCA4NS43LDE3LjQgQzkyLjMsMTcuNCA5Ni4zLDIwLjkgOTguNywyNCBMOTguOSwyNCBMOTguOSwxOC42IEwxMDcuOSwxOC42IEwxMDcuOSw1OC4yIEwxMDcuOCw1OC4yIFogTTg3LjQsNTEuNSBDOTMuNSw1MS41IDk5LjIsNDYuMiA5OS4yLDM4LjYgQzk5LjIsMzAuNiA5NCwyNS4zIDg3LjUsMjUuMyBDNzkuMywyNS4zIDc1LjQsMzEuOSA3NS40LDM4LjQgQzc1LjQsNDUgNzkuMiw1MS41IDg3LjQsNTEuNSBaIiBpZD0iU2hhcGUiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMTguNiwxOC42IEwxMjcuOCwxOC42IEwxMjcuOCwyMy42IEwxMjgsMjMuNiBDMTMxLjEsMTkuMSAxMzUuNywxNy4zIDE0MC4xLDE3LjMgQzE0OC4zLDE3LjMgMTU1LjUsMjIuNyAxNTUuNSwzNS40IEwxNTUuNSw1OC4yIEwxNDYuMiw1OC4yIEwxNDYuMiwzNS45IEMxNDYuMiwyOS4xIDE0MywyNS41IDEzNy43LDI1LjUgQzEzMS45LDI1LjUgMTI3LjksMjkuNiAxMjcuOSwzNy4zIEwxMjcuOSw1OC4zIEwxMTguNiw1OC4zIEwxMTguNiwxOC42IEwxMTguNiwxOC42IFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE4My42LDI4LjggQzE4My4yLDI1LjkgMTgxLDI0IDE3OC4zLDI0IEMxNzUuMSwyNCAxNzMuMywyNiAxNzMuMywyOC4yIEMxNzMuMywzMC42IDE3NC41LDMyLjMgMTgxLjQsMzQuNiBDMTg5LjksMzcuMyAxOTIuOSw0MS43IDE5Mi45LDQ3LjMgQzE5Mi45LDU0LjYgMTg3LjQsNTkuNyAxNzguMyw1OS43IEMxNjguOCw1OS43IDE2NC4xLDU0LjUgMTYzLjQsNDcuMSBMMTcyLDQ3LjEgQzE3Mi40LDUwLjQgMTc0LjQsNTIuOSAxNzguNSw1Mi45IEMxODIsNTIuOSAxODQsNTAuNyAxODQsNDggQzE4NCw0NSAxODIuMyw0My4xIDE3NS43LDQwLjkgQzE2OC4zLDM4LjUgMTY0LjUsMzQuOCAxNjQuNSwyOC42IEMxNjQuNSwyMi4xIDE2OS42LDE3LjMgMTc4LDE3LjMgQzE4Ni41LDE3LjMgMTkxLDIyLjMgMTkyLDI4LjggTDE4My42LDI4LjggTDE4My42LDI4LjggWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjAxLDAuNCBMMjExLjMsMC40IEwyMTEuMyw5LjggTDIwMSw5LjggTDIwMSwwLjQgWiBNMjAxLjUsMTguNiBMMjEwLjgsMTguNiBMMjEwLjgsNTguMyBMMjAxLjUsNTguMyBMMjAxLjUsMTguNiBaIiBpZD0iU2hhcGUiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yMzkuNSwyOC44IEMyMzkuMSwyNS45IDIzNi45LDI0IDIzNC4yLDI0IEMyMzEsMjQgMjI5LjIsMjYgMjI5LjIsMjguMiBDMjI5LjIsMzAuNiAyMzAuNCwzMi4zIDIzNy4zLDM0LjYgQzI0NS44LDM3LjMgMjQ4LjgsNDEuNyAyNDguOCw0Ny4zIEMyNDguOCw1NC42IDI0My4zLDU5LjcgMjM0LjIsNTkuNyBDMjI0LjcsNTkuNyAyMjAsNTQuNSAyMTkuMyw0Ny4xIEwyMjcuOSw0Ny4xIEMyMjguMyw1MC40IDIzMC4zLDUyLjkgMjM0LjQsNTIuOSBDMjM3LjksNTIuOSAyMzkuOSw1MC43IDIzOS45LDQ4IEMyMzkuOSw0NSAyMzguMiw0My4xIDIzMS42LDQwLjkgQzIyNC4yLDM4LjUgMjIwLjQsMzQuOCAyMjAuNCwyOC42IEMyMjAuNCwyMi4xIDIyNS41LDE3LjMgMjMzLjksMTcuMyBDMjQyLjQsMTcuMyAyNDYuOSwyMi4zIDI0Ny45LDI4LjggTDIzOS41LDI4LjggTDIzOS41LDI4LjggWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjUyLjgsMTguNiBMMjU3LjgsMTguNiBMMjU3LjgsNS45IEwyNjcuMSw1LjkgTDI2Ny4xLDE4LjYgTDI3NywxOC42IEwyNzcsMjYuNCBMMjY3LDI2LjQgTDI2Nyw0NC4xIEMyNjcsNDkuNSAyNjguNyw1MSAyNzIuNSw1MSBDMjc0LjEsNTEgMjc1LjksNTAuNyAyNzcuMyw1MC4zIEwyNzcuMyw1Ny44IEMyNzUuMiw1OC40IDI3Mi42LDU4LjcgMjcwLjMsNTguNyBDMjYwLjQsNTguNyAyNTcuOCw1Mi43IDI1Ny44LDQ0LjYgTDI1Ny44LDI2LjQgTDI1Mi44LDI2LjQgTDI1Mi44LDE4LjYgWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMzAyLjMsMTcuMyBDMzE0LjcsMTcuMyAzMjMuNSwyNi40IDMyMy41LDM4LjQgQzMyMy41LDUwLjEgMzE0LjYsNTkuNyAzMDIuMyw1OS43IEMyOTAuMiw1OS43IDI4MS4xLDUwLjQgMjgxLjEsMzguNCBDMjgxLjEsMjYuMSAyOTAuMywxNy4zIDMwMi4zLDE3LjMgWiBNMzAyLjMsNTEuNCBDMzA5LjMsNTEuNCAzMTQuMSw0NS44IDMxNC4xLDM4LjQgQzMxNC4xLDMxLjQgMzA5LjYsMjUuNSAzMDIuMywyNS41IEMyOTUuMiwyNS41IDI5MC41LDMxIDI5MC41LDM4LjQgQzI5MC41LDQ2IDI5NS45LDUxLjQgMzAyLjMsNTEuNCBaIiBpZD0iU2hhcGUiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNTAuOSwyNS44IEMzNDQuNiwyNS44IDM0MC45LDI5LjkgMzQwLjksMzguMiBMMzQwLjksNTguMiBMMzMxLjYsNTguMiBMMzMxLjYsMTguNiBMMzQwLjcsMTguNiBMMzQwLjcsMjQuMiBMMzQwLjksMjQuMiBDMzQyLjcsMjAuOCAzNDYuNywxNy4zIDM1MiwxNy4zIEMzNTMuNSwxNy4zIDM1NC41LDE3LjQgMzU1LjUsMTcuNSBMMzU1LjUsMjYuMiBDMzU0LjMsMjYgMzUyLjksMjUuOCAzNTAuOSwyNS44IFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cCI+CiAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNC4wMDAwMDAsIDI0LjAwMDAwMCkiIGlkPSJTaGFwZSI+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTQ4LDk1LjkgQzQ1LjQsOTUuOSA0My4yLDkzLjggNDMuMiw5MS4xIEw0My4yLDQuOSBDNDMuMiwyLjMgNDUuMywwLjEgNDgsMC4xIEM1MC42LDAuMSA1Mi44LDIuMiA1Mi44LDQuOSBMNTIuOCw5MS4xIEM1Mi44LDkzLjcgNTAuNiw5NS45IDQ4LDk1LjkgWiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yOCw1Mi44IEw1LDUyLjggQzIuNCw1Mi44IDAuMiw1MC43IDAuMiw0OCBDMC4yLDQ1LjMgMi4zLDQzLjIgNSw0My4yIEwyOCw0My4yIEMzMC42LDQzLjIgMzIuOCw0NS4zIDMyLjgsNDggQzMyLjgsNTAuNyAzMC42LDUyLjggMjgsNTIuOCBaIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkxLjEsNTIuOCBMNjgsNTIuOCBDNjUuNCw1Mi44IDYzLjIsNTAuNyA2My4yLDQ4IEM2My4yLDQ1LjMgNjUuMyw0My4yIDY4LDQzLjIgTDkxLDQzLjIgQzkzLjYsNDMuMiA5NS44LDQ1LjMgOTUuOCw0OCBDOTUuOCw1MC43IDkzLjcsNTIuOCA5MS4xLDUyLjggWiI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTcyLDE0NCBDMzIuMywxNDQgMCwxMTEuNyAwLDcyIEMwLDMyLjMgMzIuMywwIDcyLDAgQzExMS43LDAgMTQ0LDMyLjMgMTQ0LDcyIEMxNDQsMTExLjcgMTExLjcsMTQ0IDcyLDE0NCBaIE03Miw5LjYgQzM3LjYsOS42IDkuNiwzNy42IDkuNiw3MiBDOS42LDEwNi40IDM3LjYsMTM0LjQgNzIsMTM0LjQgQzEwNi40LDEzNC40IDEzNC40LDEwNi40IDEzNC40LDcyIEMxMzQuNCwzNy42IDEwNi40LDkuNiA3Miw5LjYgWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="/>{.transistor-logo}</a> ]{.powered-by} :::</p><p>::: {.break} :::</p><p>::: {.playlist-header} {{ episodes.length}} {{ show.playlist_limit ? 'latest' : '' }} episodes :::</p><p>::: {.break} :::</p><ol><li>[]{.icon-play-circle v-show="!playing || (playing &amp;&amp; selectedEpisodeIndex != index)"} []{.icon-pause-circle v-show="playing &amp;&amp; selectedEpisodeIndex === index"} [{{ episode.title }}]{.playlist-title} {{ episode.duration<em>in</em>minutes }} min ::: ::: :::</li></ol><h3>Choosing a service for Swift Package Continuous Integration</h3><p>What's important to realize is that by using a cloud service for your Swift package, you can make sure your package works everywhere. Often times, we may be have some source, artifact, or tool required to build our code. However with a cloud service, you can ensure that if your Swift package builds and tests in the cloud it will work for anyone else.</p><p>Luckily, there are some great services out there to help your Swift package especially if it's a public GitHub repository. At the present time, unfortunately, some services <strong>only</strong> support Continuous Integration for iOS Applications rather than Swift packages such as <strong><a href="https://circleci.com">Circle CI</a></strong> and <strong><a href="https://www.bitrise.io">Bitrise</a></strong>. Be that as it may, <strong><a href="https://travis-ci.com">Travis-CI</a></strong> as well as the most recent <strong><a href="https://github.com/features/actions">GitHub Actions</a></strong> allow for Swift Package Continuous Integration.<img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2020/02/TravisCI-Full-Color-2.png"/>{.alignnone .size-full .wp-image-841 width="642" height="201"}</p><h3>Travis-CI</h3><p><strong><a href="https://travis-ci.com">Travis-CI</a></strong> is one of the older Continuous Integration services out there. Most importantly for public repositories, <strong><a href="https://travis-ci.com">Travis-CI</a></strong> is completely free. In other words, you can configure your Swift package on <strong><a href="https://travis-ci.com">Travis-CI</a></strong>. In order to configure your repository, signup with <strong><a href="https://travis-ci.com">Travis-CI</a></strong> by linking your GitHub account or organization. Next you need to setup your</p><p><code>.travis.yml</code> file.</p><p>Notably, there are three key components for setting up a Swift package in Travis-CI:</p><ul><li>Specifying the correct operating system and Xcode version</li><li>Building and testing your code</li></ul><p>For example, here is a simple <code>.travis.yml</code> file:</p><pre><code>language: objective-c
os: osx
osx_image: xcode11.<span class="number">3</span>
script:
  - swift build
  - swift test
</code></pre><p>The first three properties setup the virtual machine which <strong><a href="https://travis-ci.com">Travis-CI</a></strong> uses. Next, the lines under</p><p><code>script</code> specify the commands Travis-CI needs to run to verify the Swift package is working. In this case, <strong>since we are not building from an Xcode project or workspace, we need to specify our own <em>custom</em> commands.</strong> In other words, rather than using <em>xcodebuild</em>, the Swift command line tool will build and test our package.</p><p>While Travis-CI is the most experienced cloud CI service out there, recently GitHub has also offered its own service with <strong><a href="https://github.com/features/actions">GitHub Actions</a></strong>.</p><p>::: {.wp-block-image} <img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2020/02/44036562-2.png"/>{.wp-image-840} :::</p><h3>Github Actions</h3><p>With the fairly recent release of <strong><a href="https://github.com/features/actions">GitHub Actions</a></strong>, you can setup Swift package continuous integration right from your repo. Most importantly <strong><a href="https://github.com/features/actions">GitHub Actions</a></strong> is completely free for public repositories. Therefore, let's breakdown the functionality of <strong><a href="https://github.com/features/actions">GitHub Actions</a></strong>.</p><h4>GitHub Actions Components - Workflows, Actions, Jobs and more</h4><p>In order to setup our Swift package continuous integration in GitHub Actions, we need to understand the components. Similar to Travis-CI, GitHub uses YAML for its configuration. Specifically these YAML files are known as workflow files. For example, here is a sample with the name</p><p><code>macOS</code>:</p><pre><code>name: macOS

on: [push]

jobs:
  build:
    runs-on: macos-latest
    steps:
    - uses: actions/checkout@v2
    - name: <span class="type">Build</span>
      run: swift build
    - name: <span class="type">Run</span> tests
      run: swift test
</code></pre><p>In contrast to Travis-CI, you can setup multiple of these files. Therefore as long as you store them in your repository under the</p><p><code>.github/workflow</code> folder, <strong><a href="https://github.com/features/actions">GitHub Actions</a></strong> will execute each of these workflow files on trigger.</p><p>Speaking of <em>trigger</em>, you can specify many triggers. However in the case of our Swift package, we will only be using the <code>push</code> trigger to activate this workflow.</p><p>Below the <code>on</code> trigger, we have setup one job under <code>jobs</code> called</p><p><code>build</code>. With in the <code>build</code> job, we have specified the runner type (i.e virtual environment) of <code>macOS-latest</code>. In other words, it will be using the latest version of macOS to run the series of steps.</p><pre><code>...
    steps:
    - uses: actions/checkout@v2
    - name: <span class="type">Build</span>
      run: swift build
    - name: <span class="type">Run</span> tests
      run: swift test
</code></pre><h5>GitHub Actions - Step By Step</h5><p>Below the runner type property are the series of steps specified. In this case, the first step with the single <code>uses</code> property checks out the code from the repository. While the following steps have a <code>name</code> label and a <code>run</code> command to execute: first building the Swift package (<code>swift build</code>) then running tests provided (<code>swift test</code>).</p><p>What's important to note is that each needs a custom command (via <code>run</code>) with a <code>name</code> or to use a prebuilt action from the GitHub repo such as</p><p><code>actions/checkout@v2</code> to pull the source code from the repository. Unfortunately many of the GitHub Actions provided on GitHub may not be compatible with macOS due to various requirements.</p><p>Luckily you should have Continuous Integration setup for your Swift package in both Travis-CI and GitHub Actions. However if you wish to support Linux with your Swift package, it is import to configure the Swift package continuous integration for a Linux environment as well.</p><p>::: {.wp-block-image} <img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2020/02/ubuntu_black-orange_hex.png"/>{.wp-image-839 width="379" height="86"} :::</p><h3>Linux Support for Swift Package Continuous Integration {#linux-ci}</h3><p>If you wish for your Swift package to be supported everywhere, it might be a good idea to support Linux. Therefore, it's important to have your Swift package Continuous integration to extend to Linux. Thankfully both Travis-CI and GitHub Action support Linux (i.e. Ubuntu) as well as the configuration of more than one environment per repository. First, let's understand how build matrices work in Travis-CI.</p><h4>Configuring Travis-CI for Linux</h4><p>With Travis-CI, we can use a build matrix to include more than one environment. In other words, Travis-CI will run each environment in the build matrix in parallel. Therefore, let's swap the top section specifying only macOS from above with a build matrix including both macOS and Linux (i.e. Ubuntu 18.04-bionic):</p><pre><code>jobs:
  include:
    - os: linux
      dist: bionic
      sudo: <span class="keyword">required</span>
    - os: osx
      osx_image: xcode11.<span class="number">3</span>
</code></pre><p>Now, it will run each phase in parallel on Ubuntu as well as macOS. However we'll need to make changes to both of the these sections in order to support Linux. Most importantly, we will need to install Swift.</p><p>Therefore, we will move or create the <code>script</code> and <code>before_install</code> phases into separate bash scripts and update <code>.travis.yml</code> accordingly:</p><pre><code>jobs:
  include:
    - os: linux
      dist: bionic
      sudo: <span class="keyword">required</span>
    - os: osx
      osx_image: xcode11.<span class="number">3</span>
before_install:
  - ./<span class="type">Scripts</span>/before_install.<span class="property">sh</span>
script:
  - ./<span class="type">Scripts</span>/script.<span class="property">sh</span>
</code></pre><p>Next let's create a script for <code>before_install</code> named</p><p><code>before_install.sh</code> under the <code>Scripts</code> folder with the following code:</p><pre><code>#!/bin/bash

<span class="keyword">if</span> [[ $TRAVIS_OS_NAME = 'osx' ]]; then
  # install macOS prerequistes
elif [[ $TRAVIS_OS_NAME = 'linux' ]]; then
  # download swift
  wget https://swift.<span class="property">org</span>/builds/swift-<span class="number">5.2</span>-release/ubuntu1804/swift-<span class="number">5.2</span>-<span class="type">RELEASE</span>/swift-<span class="number">5.2</span>-<span class="type">RELEASE</span>-ubuntu18.<span class="number">04</span>.<span class="property">tar</span>.<span class="property">gz</span>
  # extract the archive
  tar xzf swift-<span class="number">5.2</span>-<span class="type">RELEASE</span>-ubuntu18.<span class="number">04</span>.<span class="property">tar</span>.<span class="property">gz</span>
  # include the swift command <span class="keyword">in</span> the <span class="type">PATH</span>
  export <span class="type">PATH</span>=<span class="string">"${PWD}/swift-5.2-RELEASE-ubuntu18.04/usr/bin:$PATH"</span>
fi
</code></pre><p>Within the bash script, we check the environment variable</p><p><code>TRAVIS_OS_NAME</code> setup by Travis-CI. With the variable, we check whether it is <code>osx</code> for a macOS environment or <code>linux</code> for the Ubuntu environment.</p><p>Since Xcode is not available on Ubuntu, we need to manually within the bash script, download and extract Swift. Lastly we need to include the directory path of the Swift command tool within the environment <code>PATH</code> variable.</p><p>Correspondingly we need to make sure the <code>PATH</code> is updated in the</p><p><code>Scripts/script.sh</code> file:</p><pre><code>#!/bin/bash

<span class="keyword">if</span> [[ $TRAVIS_OS_NAME = 'osx' ]]; then
  # <span class="type">What</span> to <span class="keyword">do in</span> macOS
elif [[ $TRAVIS_OS_NAME = 'linux' ]]; then
  # <span class="type">What</span> to <span class="keyword">do in</span> <span class="type">Ubunutu</span>
  export <span class="type">PATH</span>=<span class="string">"${PWD}/swift-5.2-RELEASE-ubuntu18.04/usr/bin:$PATH"</span>
fi

swift build
swift test
</code></pre><p>Therefore the only major change within the <code>script</code> section of the Travis-CI configuration is including the path to the Swift command line tool.</p><p>As a result, each time a push is made to the repository, Travis-CI will run both a macOS and Ubuntu process. In effect, we have setup Swift package continuous integration for both operating systems in Travis-CI. Accordingly, let's do the same thing for GitHub Actions.</p><h4>Configuring GitHub Actions for Linux</h4><p>While Travis-CI requires us to check the operating system within the build script, GitHub Actions allows us to use separate workflow files for each operating system.</p><pre><code>name: ubuntu

on: [push]

jobs:
  build:

    runs-on: ubuntu-<span class="number">18.04</span>

    steps:
    - uses: actions/checkout@v2
    - name: <span class="type">Download Swift</span> <span class="number">5.2</span>
      run: wget -q https://swift.<span class="property">org</span>/builds/swift-<span class="number">5.2</span>-release/ubuntu1804/swift-<span class="number">5.2</span>-<span class="type">RELEASE</span>/swift-<span class="number">5.2</span>-<span class="type">RELEASE</span>-ubuntu18.<span class="number">04</span>.<span class="property">tar</span>.<span class="property">gz</span>
    - name: <span class="type">Extract Swift</span> <span class="number">5.2</span>
      run: tar xzf swift-<span class="number">5.2</span>-<span class="type">RELEASE</span>-ubuntu18.<span class="number">04</span>.<span class="property">tar</span>.<span class="property">gz</span>
    - name: <span class="type">Add Path</span>
      run: echo <span class="string">"::add-path::$GITHUB_WORKSPACE/swift-5.2-RELEASE-ubuntu18.04/usr/bin"</span>
    - name: <span class="type">Build</span>
      run: swift build
    - name: <span class="type">Run</span> tests
      run: swift test
</code></pre><p>In this case, each command is stored within an individual step. As can be seen, the one custom part is the method we use to add the path using GitHub Actions logging commands and variables. With</p><p><code>echo "::add-path::$GITHUB_WORKSPACE/swift-5.2-RELEASE-ubuntu18.04/usr/bin"</code>, we update the <code>PATH</code> variable.</p><p>As a result, your Swift package continuous integration should support Linux via Travis-CI and GitHub Action. However, there are a few steps in order to support Linux when it comes to testing.</p><h2>Testing, CI, and Linux {#testing}</h2><img src="https://i1.wp.com/learningswift.brightdigit.com/wp-content/uploads/sites/2/2020/03/linux-test-swift.png?fit=640%2C316&ssl=1"/><p>{.wp-image-875}</p><p>When it comes to verifying whether your package works correctly, having the right unit tests are a major component of that. Luckily, if you are using the XCTest framework and setup the CI scaffold previously described, you should be good to go. However with Linux, XCTest will not automatically provide all the correct tests in your application without some modifications. There are a few ways of doing this:</p><ol><li>Manually update your XCTestManifests.swift and LinuxMain.swift :(</li><li>Run <code>swift test --generate-linuxmain</code> **before commit on your macOS machine** to let the swift command line tool update your LinuxMain.swift.</li><li><strong>Update your CI for Linux</strong> to run <code>swift test --enable-test-discovery</code> which will automatically discover and run your tests.</li></ol><p>If you are interested in learning more about this check out Ole Begemann's piece on <a href="https://oleb.net/blog/2017/03/keeping-xctest-in-sync/">keeping XCTest in sync</a> as well as <a href="https://oleb.net/2020/swift-test-discovery/">how automatic test discovery works</a>.</p><p>Now that we have our unit tests working correctly, let's look into keeping tracking of code coverage.</p><h3>Integrating Code Coverage</h3><p>Code coverage is a good way to keep track of how well your unit tests are handling. Luckily there are some great services out there to keep track of your code coverage as you build your Swift package.</p><p>::: {.wp-block-image} <img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2020/02/7c4f41a-pink.png"/>{.wp-image-838 width="150" height="150"} :::</p><h4>CodeCov</h4><p><strong><a href="http://codecov.io/">CodeCov.io</a></strong> is one such service which we can plugin into our Swift Package Continuous Integration setup. However, once you have signed up and added your public repository, it will take some configuration to make it work completely.</p><p>For instance, we must make sure that the tests, build a report, convert the report to a compatible format, then lastly upload the the report to <strong><a href="http://codecov.io/">CodeCov.io</a></strong>. Building the report when you run the unit tests is fairly easy. In this case, we simply need to add the flag <code>--enable-code-coverage</code> to our <code>swift test</code> for both Travis-CI and GitHub Actions; macOS and Linux:</p><pre><code>swift test --enable-code-coverage
</code></pre><p>Next, we need to prepare the report for upload using <code>llvm-cov</code>. With this in mind, on macOS you can use <code>xcrun</code> to run <code>llvm-cov</code>:</p><pre><code>xcrun llvm-cov export -format=<span class="string">"lcov"</span> .<span class="dotAccess">build</span>/debug/${{<span class="type">FRAMEWORK_NAME</span>}}<span class="type">PackageTests</span>.<span class="property">xctest</span>/<span class="type">Contents</span>/<span class="type">MacOS</span>/${{<span class="type">FRAMEWORK_NAME</span>}}<span class="type">PackageTests</span> -instr-profile .<span class="dotAccess">build</span>/debug/codecov/<span class="keyword">default</span>.<span class="property">profdata</span> &gt; info.<span class="property">lcov</span>
</code></pre><p>Corresponding in Linux, we can run <code>llvm-cov</code> manually:</p><pre><code>llvm-cov export -format=<span class="string">"lcov"</span> .<span class="dotAccess">build</span>/x86_64-unknown-linux-gnu/debug/${{<span class="type">FRAMEWORK_NAME</span>}}<span class="type">PackageTests</span>.<span class="property">xctest</span> -instr-profile .<span class="dotAccess">build</span>/debug/codecov/<span class="keyword">default</span>.<span class="property">profdata</span> &gt; info.<span class="property">lcov</span>
</code></pre><p>Simply replace <code>${{FRAMEWORK_NAME}}</code> with your Swift package name or even better setup an environment variable in Travis-CI and GitHub Actions.</p><p>Lastly, we need to upload the report using the Bash script provided by CodeCov.io:</p><pre><code>bash &lt;(curl https://codecov.<span class="property">io</span>/bash)
</code></pre><p>While Travis-CI automatically integrates with CodeCov.io, GitHub does require <a href="https://docs.codecov.io/docs/about-the-codecov-bash-uploader">manually setting up the token for CodeCov.io</a>:</p><ol><li>First, go to your project in CodeCov.io and copy the token from the project overview.</li><li>Go to your GitHub repository settings and under <em>Secrets</em> add the token under the name <code>CODECOV_TOKEN</code>.</li><li>Under both the macOS and ubuntu workflow files, add the <code>CODECOV_TOKEN</code> as the environment variable under the upload step.</li></ol><p>For example, here's the Ubuntu workflow file which uses an environment variable for the Swift package name and maps the <code>CODECOV_TOKEN</code> secret to the uploader command environment variable:</p><pre><code>...
    - name: <span class="type">Run</span> tests
      run: swift test --enable-code-coverage
    - name: <span class="type">Prepare Code Coverage</span>
      run: llvm-cov export -format=<span class="string">"lcov"</span> .<span class="dotAccess">build</span>/x86_64-unknown-linux-gnu/debug/${{ env.<span class="type">PACKAGE_NAME</span> }}<span class="type">PackageTests</span>.<span class="property">xctest</span> -instr-profile .<span class="dotAccess">build</span>/debug/codecov/<span class="keyword">default</span>.<span class="property">profdata</span> &gt; info.<span class="property">lcov</span>
    - name: <span class="type">Upload</span> to <span class="type">CodeCov</span>.<span class="property">io</span>
      run: bash &lt;(curl https://codecov.<span class="property">io</span>/bash)
      env:
          <span class="type">CODECOV_TOKEN</span>: ${{ secrets.<span class="type">CODECOV_TOKEN</span> }}
</code></pre><p>Now that we have completed setting up a code coverage report with <strong>CodeCov.io</strong>, Let's talk about ensuring good code quality.</p><p>::: {.wp-block-image} <img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2020/02/medal-150x150.png"/>{.wp-image-837} :::</p><h2>Code Quality and CI {#code-quality}</h2><p>There are some great automated ways we can keep up code quality inside our Swift package continuous integration. However, nothing replaces a good code review. If you can, have some sort of code review process by someone else. If it's difficult to find someone else, I suggest reviewing a Swift package's code after some down time to ensure you can have a fresh look at your code.</p><p>Regardless, let's look at some of the ways we can automate code quality checks.</p><h3>Formatting, Beautification, and Linting</h3><p>There are two command line tools I use to maintain quality code while keeping formatting consistent: <strong><a href="https://github.com/nicklockwood/SwiftFormat">SwiftFormat</a></strong> and <strong><a href="https://github.com/realm/SwiftLint">SwiftLint</a></strong>. Fortunately, each application can be installed via Homebrew. Therefore, we can use Homebrew bundle to automate the installation of both applications inside our Swift package continuous integration. With this in mind, add a file called <code>Brewfile</code> to the root of repository with the following text:</p><pre><code>brew <span class="string">"swiftformat"</span>
brew <span class="string">"swiftlint"</span>
</code></pre><p>Next we need to add the installation these applications in the earliest part of our CI setup. However these applications will only work on macOS and we need to verify that as well. Therefore we modify our</p><p><code>before_install.sh</code> script for Travis-CI with:</p><pre><code>...
<span class="keyword">if</span> [[ $TRAVIS_OS_NAME = 'osx' ]]; then
  brew update
  brew bundle
elif [[ $TRAVIS_OS_NAME = 'linux' ]]; then
...
</code></pre><p>Meanwhile, for Github Actions, we simply need to add steps to our macOS workflow file:</p><pre><code>...
  steps:
    - uses: actions/checkout@v2
    - name: <span class="type">Prepare Build</span>
      run: brew bundle
...
</code></pre><p>Lastly we need to add the following command to verify code quality after the installation:</p><pre><code>swiftformat --lint . &amp;&amp; swiftlint
</code></pre><p>In short, this command will run both applications in the CI process. Specifically we run <code>swiftformat</code> in linter mode, since our expectation is that the developer has already formatted the code correctly before commit. Correspondingly, with <code>swiftlint</code>, you can use the <code>autocorrect</code> subcommand to fix some linter errors in your code before commit.</p><p>Again, for Travis-CI, verify the <code>$TRAVIS_OS_NAME</code> is <code>osx</code>, so the CI doesn't run the tool in Linux.</p><p>Beside installation and execution of the tools within the Swift package continuous integration, you should probably add configuration files for both tools. In brief, these are <code>.swiftformat</code> and <code>.swiftlint.yml</code>. Futhermore, check out both the <strong><a href="https://github.com/nicklockwood/SwiftFormat">SwiftFormat</a></strong> and <strong><a href="https://github.com/realm/SwiftLint">SwiftLint</a></strong> projects for details on how setup these configurations.</p><p>::: {.iframe} ::: {#embed-app episodes="[{"id":199010,"title":"Managing Code Quality with Anne Cahalan","episode<em>type":"full","number":39,"season":1,"formatted</em>published<em>at":"March 1, 2020","duration":3540,"duration</em>in<em>minutes":59,"duration</em>in<em>mmss":"59:00","trackable</em>media<em>url":"https://pdcn.co/e/media.transistor.fm/99f236b1/fcf3527f.mp3","share</em>url":"https://share.transistor.fm/s/99f236b1","transcript<em>url":null,"artwork":"https://images.transistor.fm/file/transistor/images/episode/199010/thumb</em>1582306595-artwork.jpg","author":"Leo Dion, Principal CEO and Swift Developer at BrightDigit ","formatted<em>summary":"In this episode, Leo talks with Anne Cahalan about maintaining good code quality, helping your team, automation, and good code reviews.","embed</em>html":"u003ciframe width="100%" height="180" frameborder="no" scrolling="no" seamless src="https://share.transistor.fm/e/99f236b1"u003eu003c/iframeu003e"}]" show="{"id":122,"title":"Empower Apps","website":"https://www.empowerapps.show","multiple<em>seasons":false,"playlist</em>limit":7,"feed<em>url":"https://feeds.transistor.fm/empowerapps-show","private</em>feed":false,"disable<em>feed":false,"disable</em>downloads":false,"apple<em>podcasts</em>url":"https://itunes.apple.com/us/podcast/empower-apps/id1437435392?mt=2","spotify":"https://open.spotify.com/show/0TGuZyeXPPyxYe1JApM6Z5","overcast":"https://overcast.fm/itunes1437435392/empower-apps","stitcher":"https://www.stitcher.com/s?fid=240018u0026refid=stpr","pocket<em>casts":"https://pca.st/9n7e","castro":"https://castro.fm/itunes/1437435392","podcast</em>addict":"https://podcastaddict.com/podcast/2393954","deezer":"","google<em>podcasts":"https://www.google.com/podcasts?feed=aHR0cHM6Ly9mZWVkcy50cmFuc2lzdG9yLmZtL2VtcG93ZXJhcHBzLXNob3c%3D","radioPublic":"https://radiopublic.com/empower-apps-WezKN2","breaker":"https://www.breaker.audio/empower-apps","tuneIn":"http://tun.in/pjaZJ","castbox":"https://castbox.fm/ch/1453575","pandora":"https://www.pandora.com/podcast/empower-apps/PC:21228","iHeartRadio":"https://iheart.com/podcast/78369923/","soundcloud":"","amazon</em>music":"https://music.amazon.com/podcasts/0e053161-686d-47e6-91a1-31d55b121423/Empower-Apps","player_FM":"https://player.fm/series/empower-apps"}"} ::: {#embed-player .player-large .player-light :class="{ 'player-playlist': isPlaylist }" aria-label="Audio Player for Empower Apps" tabindex="1"} ::: {.player-main} ::: {.player-artwork tabindex="-1"} []{.play-btn .icon-play-circle v-show="!playing" title="Play" aria-hidden="true" focusable="false"} []{.pause-btn .icon-pause-circle v-show="playing" title="Pause" aria-hidden="true" focusable="false"}</p><p>::: {.loader-ring v-show="loading"} ::: :::</p><p>::: {.player} ::: {.playback-progress} ::: {.currently-playing} ::: {.show-title} <strong>{{ show.title }}</strong> â€¢ [Trailer]{v-if="selectedEpisode.episode<em>type === 'trailer'"} [Bonus]{v-if="selectedEpisode.episode</em>type === 'bonus'"} [Episode {{ selectedEpisode.number }}]{v-if="selectedEpisode.number"} â€¢ Season {{ selectedEpisode.season }} :::</p><p>::: {.title} {{ selectedEpisode.title }} ::: :::</p><p>::: {.play-progress} []{.play-btn .icon-play-circle v-show="!playing" title="Play" aria-hidden="true" focusable="false"} []{.pause-btn .icon-pause-circle v-show="playing" title="Pause" aria-hidden="true" focusable="false"}</p><p>::: {.loader-ring v-show="loading"} :::</p><p>::: {#progressBar title="Seek" @click="seekTo" aria-label="Seek within Episode"} []{#progress :style="{ left: '-'+ progressBar + '%' }"} ::: :::</p><p>::: {.playback-controls} ::: {.playback-duration} {{ currentTimer }}|{{ currentDuration }} :::</p><p>::: {.volume-speed-controls} {{ displaySpeed }}x ::: ::: :::</p><p>[Subscribe]{#subscribeBtn} [Share]{#shareBtn} [More Info]{#infoBtn} :::</p><p>::: {.subscribe .panel :class="{ expanded: expandedPanel === 'subscribe' }"} []{.close-btn .icon-cancel-circle @click.prevent="closePanel"}</p><p>::: {.title} Subscribe :::</p><p>::: {.copyable-input v-if="!show.private<em>feed &amp;&amp; !show.disable</em>feed"} RSS Feed []{.copy-btn .icon-copy v-clipboard:copy="feed_url" v-clipboard:success="onCopy" title="Copy to clipboard" aria-label="Copy RSS Feed URL to clipboard"} :::</p><p>::: {.social-links} Apple Podcasts Google Podcasts Spotify Pocket Casts Overcast Castro Amazon Music Breaker Stitcher RadioPublic Pandora CastBox iHeartRadio TuneIn Player FM SoundCloud Deezer Podcast Addict ::: :::</p><p>::: {.sharing .panel :class="{ expanded: expandedPanel === 'sharing' }"} []{.close-btn .icon-cancel-circle @click.prevent="closePanel"}</p><p>::: {.title} Share :::</p><p>::: {.copyable-input} Embed []{.copy-btn .icon-copy v-clipboard:copy="embed_html" v-clipboard:success="onCopy" title="Copy to clipboard" aria-label="Copy Embed code to clipboard"} :::</p><p>::: {.copyable-input v-if="!show.private<em>feed"} Share []{.copy-btn .icon-copy v-clipboard:copy="share</em>url" v-clipboard:success="onCopy" title="Copy to clipboard" aria-label="Copy Share URL to clipboard"} :::</p><p>::: {.share-links} []{.twitter .icon-twitter-circle} []{.facebook .icon-facebook-circle} []{.download .icon-download-circle} ::: :::</p><p>::: {.details .panel :class="{ expanded: expandedPanel === 'more' }"} []{.close-btn .icon-cancel-circle @click.prevent="closePanel"} <strong>{{ selectedEpisode.formatted<em>published</em>at }}</strong> â€¢ [Trailer]{v-if="selectedEpisode.episode<em>type === 'trailer'"} [Bonus]{v-if="selectedEpisode.episode</em>type === 'bonus'"} [Episode {{ selectedEpisode.number }}]{v-if="selectedEpisode.number"} â€¢ Season {{ selectedEpisode.season }}</p><p>::: {.details-title} {{ selectedEpisode.title }} :::</p><p>::: {.details-author} By {{ selectedEpisode.author }} â€¢ Full Transcript â€¢ View the Website :::</p><p>::: {.details-summary v-html="selectedEpisode.formatted_summary"} ::: :::</p><p>[ <a href="https://transistor.fm "Broadcast by Transistor.fm""><strong>Broadcast by</strong> <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNTQ3cHgiIGhlaWdodD0iMTQ0cHgiIHZpZXdib3g9IjAgMCA1NDcgMTQ0IiB2ZXJzaW9uPSIxLjEiIGNsYXNzPSJ0cmFuc2lzdG9yLWxvZ28iPgogICAgPGRlZnM+PC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9InRyYW5zaXN0b3JfaG9yaXpvbnRhbCIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSIjRkZGRkZGIj4KICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTEuMDAwMDAwLCA0Mi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgcG9pbnRzPSIwLjcgMTAuNCAwLjcgMS44IDM4LjYgMS44IDM4LjYgMTAuNCAyNC41IDEwLjQgMjQuNSA1OC4zIDE0LjcgNTguMyAxNC43IDEwLjQiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02My4zLDI2LjIgQzYyLjEsMjYgNjAuNywyNS44IDU4LjcsMjUuOCBDNTIuNCwyNS44IDQ4LjcsMjkuOSA0OC43LDM4LjIgTDQ4LjcsNTguMiBMMzkuNCw1OC4yIEwzOS40LDE4LjYgTDQ4LjUsMTguNiBMNDguNSwyNC4yIEw0OC43LDI0LjIgQzUwLjUsMjAuOCA1NC41LDE3LjMgNTkuOCwxNy4zIEM2MS4zLDE3LjMgNjIuMywxNy40IDYzLjMsMTcuNSBMNjMuMywyNi4yIEw2My4zLDI2LjIgWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTA3LjgsNTguMiBMOTguOCw1OC4yIEw5OC44LDUzLjIgTDk4LjYsNTMuMiBDOTUuOSw1Ni42IDkxLjYsNTkuNyA4NSw1OS43IEM3Ni4xLDU5LjcgNjYsNTIuNiA2NiwzOC40IEM2NiwyNS44IDc0LjksMTcuNCA4NS43LDE3LjQgQzkyLjMsMTcuNCA5Ni4zLDIwLjkgOTguNywyNCBMOTguOSwyNCBMOTguOSwxOC42IEwxMDcuOSwxOC42IEwxMDcuOSw1OC4yIEwxMDcuOCw1OC4yIFogTTg3LjQsNTEuNSBDOTMuNSw1MS41IDk5LjIsNDYuMiA5OS4yLDM4LjYgQzk5LjIsMzAuNiA5NCwyNS4zIDg3LjUsMjUuMyBDNzkuMywyNS4zIDc1LjQsMzEuOSA3NS40LDM4LjQgQzc1LjQsNDUgNzkuMiw1MS41IDg3LjQsNTEuNSBaIiBpZD0iU2hhcGUiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMTguNiwxOC42IEwxMjcuOCwxOC42IEwxMjcuOCwyMy42IEwxMjgsMjMuNiBDMTMxLjEsMTkuMSAxMzUuNywxNy4zIDE0MC4xLDE3LjMgQzE0OC4zLDE3LjMgMTU1LjUsMjIuNyAxNTUuNSwzNS40IEwxNTUuNSw1OC4yIEwxNDYuMiw1OC4yIEwxNDYuMiwzNS45IEMxNDYuMiwyOS4xIDE0MywyNS41IDEzNy43LDI1LjUgQzEzMS45LDI1LjUgMTI3LjksMjkuNiAxMjcuOSwzNy4zIEwxMjcuOSw1OC4zIEwxMTguNiw1OC4zIEwxMTguNiwxOC42IEwxMTguNiwxOC42IFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE4My42LDI4LjggQzE4My4yLDI1LjkgMTgxLDI0IDE3OC4zLDI0IEMxNzUuMSwyNCAxNzMuMywyNiAxNzMuMywyOC4yIEMxNzMuMywzMC42IDE3NC41LDMyLjMgMTgxLjQsMzQuNiBDMTg5LjksMzcuMyAxOTIuOSw0MS43IDE5Mi45LDQ3LjMgQzE5Mi45LDU0LjYgMTg3LjQsNTkuNyAxNzguMyw1OS43IEMxNjguOCw1OS43IDE2NC4xLDU0LjUgMTYzLjQsNDcuMSBMMTcyLDQ3LjEgQzE3Mi40LDUwLjQgMTc0LjQsNTIuOSAxNzguNSw1Mi45IEMxODIsNTIuOSAxODQsNTAuNyAxODQsNDggQzE4NCw0NSAxODIuMyw0My4xIDE3NS43LDQwLjkgQzE2OC4zLDM4LjUgMTY0LjUsMzQuOCAxNjQuNSwyOC42IEMxNjQuNSwyMi4xIDE2OS42LDE3LjMgMTc4LDE3LjMgQzE4Ni41LDE3LjMgMTkxLDIyLjMgMTkyLDI4LjggTDE4My42LDI4LjggTDE4My42LDI4LjggWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjAxLDAuNCBMMjExLjMsMC40IEwyMTEuMyw5LjggTDIwMSw5LjggTDIwMSwwLjQgWiBNMjAxLjUsMTguNiBMMjEwLjgsMTguNiBMMjEwLjgsNTguMyBMMjAxLjUsNTguMyBMMjAxLjUsMTguNiBaIiBpZD0iU2hhcGUiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yMzkuNSwyOC44IEMyMzkuMSwyNS45IDIzNi45LDI0IDIzNC4yLDI0IEMyMzEsMjQgMjI5LjIsMjYgMjI5LjIsMjguMiBDMjI5LjIsMzAuNiAyMzAuNCwzMi4zIDIzNy4zLDM0LjYgQzI0NS44LDM3LjMgMjQ4LjgsNDEuNyAyNDguOCw0Ny4zIEMyNDguOCw1NC42IDI0My4zLDU5LjcgMjM0LjIsNTkuNyBDMjI0LjcsNTkuNyAyMjAsNTQuNSAyMTkuMyw0Ny4xIEwyMjcuOSw0Ny4xIEMyMjguMyw1MC40IDIzMC4zLDUyLjkgMjM0LjQsNTIuOSBDMjM3LjksNTIuOSAyMzkuOSw1MC43IDIzOS45LDQ4IEMyMzkuOSw0NSAyMzguMiw0My4xIDIzMS42LDQwLjkgQzIyNC4yLDM4LjUgMjIwLjQsMzQuOCAyMjAuNCwyOC42IEMyMjAuNCwyMi4xIDIyNS41LDE3LjMgMjMzLjksMTcuMyBDMjQyLjQsMTcuMyAyNDYuOSwyMi4zIDI0Ny45LDI4LjggTDIzOS41LDI4LjggTDIzOS41LDI4LjggWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjUyLjgsMTguNiBMMjU3LjgsMTguNiBMMjU3LjgsNS45IEwyNjcuMSw1LjkgTDI2Ny4xLDE4LjYgTDI3NywxOC42IEwyNzcsMjYuNCBMMjY3LDI2LjQgTDI2Nyw0NC4xIEMyNjcsNDkuNSAyNjguNyw1MSAyNzIuNSw1MSBDMjc0LjEsNTEgMjc1LjksNTAuNyAyNzcuMyw1MC4zIEwyNzcuMyw1Ny44IEMyNzUuMiw1OC40IDI3Mi42LDU4LjcgMjcwLjMsNTguNyBDMjYwLjQsNTguNyAyNTcuOCw1Mi43IDI1Ny44LDQ0LjYgTDI1Ny44LDI2LjQgTDI1Mi44LDI2LjQgTDI1Mi44LDE4LjYgWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMzAyLjMsMTcuMyBDMzE0LjcsMTcuMyAzMjMuNSwyNi40IDMyMy41LDM4LjQgQzMyMy41LDUwLjEgMzE0LjYsNTkuNyAzMDIuMyw1OS43IEMyOTAuMiw1OS43IDI4MS4xLDUwLjQgMjgxLjEsMzguNCBDMjgxLjEsMjYuMSAyOTAuMywxNy4zIDMwMi4zLDE3LjMgWiBNMzAyLjMsNTEuNCBDMzA5LjMsNTEuNCAzMTQuMSw0NS44IDMxNC4xLDM4LjQgQzMxNC4xLDMxLjQgMzA5LjYsMjUuNSAzMDIuMywyNS41IEMyOTUuMiwyNS41IDI5MC41LDMxIDI5MC41LDM4LjQgQzI5MC41LDQ2IDI5NS45LDUxLjQgMzAyLjMsNTEuNCBaIiBpZD0iU2hhcGUiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNTAuOSwyNS44IEMzNDQuNiwyNS44IDM0MC45LDI5LjkgMzQwLjksMzguMiBMMzQwLjksNTguMiBMMzMxLjYsNTguMiBMMzMxLjYsMTguNiBMMzQwLjcsMTguNiBMMzQwLjcsMjQuMiBMMzQwLjksMjQuMiBDMzQyLjcsMjAuOCAzNDYuNywxNy4zIDM1MiwxNy4zIEMzNTMuNSwxNy4zIDM1NC41LDE3LjQgMzU1LjUsMTcuNSBMMzU1LjUsMjYuMiBDMzU0LjMsMjYgMzUyLjksMjUuOCAzNTAuOSwyNS44IFoiIGlkPSJTaGFwZSI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cCI+CiAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNC4wMDAwMDAsIDI0LjAwMDAwMCkiIGlkPSJTaGFwZSI+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTQ4LDk1LjkgQzQ1LjQsOTUuOSA0My4yLDkzLjggNDMuMiw5MS4xIEw0My4yLDQuOSBDNDMuMiwyLjMgNDUuMywwLjEgNDgsMC4xIEM1MC42LDAuMSA1Mi44LDIuMiA1Mi44LDQuOSBMNTIuOCw5MS4xIEM1Mi44LDkzLjcgNTAuNiw5NS45IDQ4LDk1LjkgWiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yOCw1Mi44IEw1LDUyLjggQzIuNCw1Mi44IDAuMiw1MC43IDAuMiw0OCBDMC4yLDQ1LjMgMi4zLDQzLjIgNSw0My4yIEwyOCw0My4yIEMzMC42LDQzLjIgMzIuOCw0NS4zIDMyLjgsNDggQzMyLjgsNTAuNyAzMC42LDUyLjggMjgsNTIuOCBaIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkxLjEsNTIuOCBMNjgsNTIuOCBDNjUuNCw1Mi44IDYzLjIsNTAuNyA2My4yLDQ4IEM2My4yLDQ1LjMgNjUuMyw0My4yIDY4LDQzLjIgTDkxLDQzLjIgQzkzLjYsNDMuMiA5NS44LDQ1LjMgOTUuOCw0OCBDOTUuOCw1MC43IDkzLjcsNTIuOCA5MS4xLDUyLjggWiI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTcyLDE0NCBDMzIuMywxNDQgMCwxMTEuNyAwLDcyIEMwLDMyLjMgMzIuMywwIDcyLDAgQzExMS43LDAgMTQ0LDMyLjMgMTQ0LDcyIEMxNDQsMTExLjcgMTExLjcsMTQ0IDcyLDE0NCBaIE03Miw5LjYgQzM3LjYsOS42IDkuNiwzNy42IDkuNiw3MiBDOS42LDEwNi40IDM3LjYsMTM0LjQgNzIsMTM0LjQgQzEwNi40LDEzNC40IDEzNC40LDEwNi40IDEzNC40LDcyIEMxMzQuNCwzNy42IDEwNi40LDkuNiA3Miw5LjYgWiIgaWQ9IlNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="/>{.transistor-logo}</a> ]{.powered-by} :::</p><p>::: {.break} :::</p><p>::: {.playlist-header} {{ episodes.length}} {{ show.playlist_limit ? 'latest' : '' }} episodes :::</p><p>::: {.break} :::</p><ol><li>[]{.icon-play-circle v-show="!playing || (playing &amp;&amp; selectedEpisodeIndex != index)"} []{.icon-pause-circle v-show="playing &amp;&amp; selectedEpisodeIndex === index"} [{{ episode.title }}]{.playlist-title} {{ episode.duration<em>in</em>minutes }} min ::: ::: :::</li></ol><h3>Cloud-Based Code Quality Services</h3><p>Besides <strong><a href="https://github.com/nicklockwood/SwiftFormat">SwiftFormat</a></strong> and <strong><a href="https://github.com/realm/SwiftLint">SwiftLint</a></strong>, there are a few cloud based code quality tools which easily integrate with your public GitHub repository. Therefore, you may be interested in:</p><ul><li><strong><a href="https://www.codefactor.io/">CodeFactor.io</a></strong></li><li><strong><a href="https://codebeat.co">CodeBeat</a></strong></li><li><strong><a href="https://codeclimate.com">CodeClimate</a></strong></li><li><strong><a href="https://houndci.com">HoundCI</a></strong></li></ul><p>After having setup these various tools, it's worth taking a look at some various issues which may crop up.</p><h3>Common Code Quality Issues</h3><p>Now that we have setup our Swift package continuous integration and plugged in several services, there are few issues you could resolve which will show up:</p><h4>Cyclomatic Complexity</h4><p><em>Cyclomatic Complexity</em> refers to the complexity of the code specifically when it comes to testability. In the end, if your code contains several logical paths, it is best to break these up. For instance, using <em>Protocol Oriented Programming</em>, you can have a protocol to test the case. Then, for each case use individual implementations and store them in an array. For instance, rather than:</p><pre><code><span class="keyword">if</span> a == <span class="number">0</span> {
  <span class="keyword">if</span> b == <span class="number">0</span> {
  } ...
...
} <span class="keyword">else if</span> a == <span class="number">1</span> {
...
} <span class="keyword">else if</span> a == <span class="number">2</span>
...
}
</code></pre><p>Use a protocol which does:</p><pre><code><span class="keyword">protocol</span> Doer {
  <span class="keyword">func</span> test (<span class="keyword">_</span> a: <span class="type">Int</span>, <span class="keyword">_</span> b: <span class="type">Int</span>) -&gt; <span class="type">Result</span>?
}

<span class="keyword">let</span> implementations : [<span class="type">Doer</span>] = [<span class="type">FooDoer</span>(), <span class="type">BarDoer</span>()]

<span class="keyword">var</span> result : <span class="type">Result</span>?

<span class="keyword">for</span> implementation <span class="keyword">in</span> implmentations <span class="keyword">while</span> result == <span class="keyword">nil</span> {
  result = <span class="call">implementation</span>(a, b)
}
</code></pre><p>As a result, testing and maintaining this code becomes much more simple.</p><h4>Cognitive Complexity</h4><p>While Cyclomatic Complexity determines how difficult your code will be to test, Cognitive Complexity is how difficult it is to read and understand. Therefore much of this involves breaks in logic, and unnecessary loop statements. However by making your code flow clearly from top to bottom this can be avoided.</p><h4>File and Function Too Long</h4><p>One of the easiest metrics of complexity is the length of your files and functions. In the end, simply refactoring should resolve the issue. To put it differently, break down large functions, classes, and structs into smaller components. At the same time, you may find a class which is difficult to split up such as a <code>UITableViewController</code>. In this case, Swift extensions are a great way to resolve this.</p><h4>Assignment Branch Condition</h4><p>Assignment Branch Condition typically is calculated based on the number of assignments, branches, and conditions as opposed to simply length. Therefore, this can be resolved by separating your functions into smaller pieces. In other words, reduce these complex elements from one function into several.</p><hr><p>Many of these code quality issues should be resolved, however it is good to not be overly concerned with some of these metrics. Similar to code coverage, it is much more a case-by-case need for resolution.</p><p>Additionally there can easily be instances of false positives such as <em>identical code</em> issues. In the end, it's important to have a measured but determined approach to code quality.</p><p>::: {.wp-block-image} <img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2020/03/book-2.png"/>{.wp-image-877} :::</p><h2>Documenting Your Swift Package {#documentation}</h2><p>If you intend to distribute your Swift package to the public then it's important to document your code and make that documentation easily available. In the first place, take a look at <a href="https://developer.apple.com/library/archive/documentation/Xcode/Reference/xcode_markup_formatting_ref/">Apple's guidance on documenting Swift code</a> as well as:</p><ul><li><a href="https://sarunw.com/posts/swift-documentation/"><strong>Swift Documentation</strong> by Sarun Wongpatcharapakorn</a></li><li><a href="https://nshipster.com/swift-documentation/"><strong>Swift Documentation</strong> - NSHipster</a></li></ul><p>Once you've properly documented your Swift package API, let's add code documentation to our Swift package continuous integration.</p><p>Primarily, you have the option of using either <strong><a href="https://github.com/realm/jazzy">Jazzy by Realm</a></strong> or <a href="https://github.com/eneko/SourceDocs"><strong>SourceDocs</strong></a>. Each has their advantage depending on whether you wish to build a complete static HTML site. In that case, I would recommend <strong><a href="https://github.com/realm/jazzy">Jazzy</a></strong>. Especially considering the maturity of <strong><a href="https://github.com/realm/jazzy">Jazzy</a></strong>, it can be an excellent tool. On the other hand, if you wish to simply output Markdown for your package documentation, I'd recommend <a href="https://github.com/eneko/SourceDocs"><strong>SourceDocs</strong></a>.</p><h3>Using SourceDocs</h3><p>To build documentation using <code>sourcedocs</code>, first build your Swift package using <code>swift build</code>. Once your package is built, you run</p><p><code>sourcedocs</code> using:</p><pre><code>sourcedocs generate --spm-module <span class="type">PACKAGE_NAME</span>
</code></pre><p>Additionally, you can use a different output directory besides</p><p><code>Documentation</code>, such as <code>docs</code>. In order to do that, you can use the flag <code>--output-folder</code> like so:</p><pre><code>sourcedocs generate --spm-module <span class="type">PACKAGE_NAME</span> --output-folder docs
</code></pre><p>Furthermore, we can take the next step and integrate <code>sourcedocs</code> into our Swift package Continuous Integration.</p><h4>Adding SourceDocs to Swift Package Continuous Integration</h4><p>Similar to our other tools, we need to add <code>sourcedocs</code> to our Homebrew bundle file:</p><pre><code>brew <span class="string">"swiftformat"</span>
brew <span class="string">"swiftlint"</span>
brew <span class="string">"sourcedocs"</span>
</code></pre><p>Next in our macOS GitHub Action workflow file, we can add a step to build the documentation:</p><pre><code>     - name: <span class="type">Build Documentation</span>
      run: sourcedocs generate --spm-module ${{ env.<span class="type">PACKAGE_NAME</span> }} --output-folder docs
</code></pre><p>Lastly, in order to make sure our change is pushed, we need to add a step to commit and push any documentation changes:</p><pre><code>     - name: <span class="type">Commit</span> files
      run: |
        git config --local user.<span class="property">email</span> <span class="string">"action@github.com"</span>
        git config --local user.<span class="property">name</span> <span class="string">"GitHub Action"</span>
        git status
        git add [<span class="type">DOCUMENTATION DIRECTORY</span>]
        git diff-index --quiet <span class="type">HEAD</span> || git commit -m <span class="string">"[github action] Update Docs"</span>
        git push
</code></pre><p>A point often overlooked, is that this will fail if there is an already existing push committed while this CI takes place. Therefore, in those cases, the CI will fail. If you are concerned, I would recommend looking at using a pull request rather than a direct push to the branch.</p><p>After having built documentation for our swift package, it is important to make our package discoverable to others.</p><h2>Making Your Swift Package Available {#distrbuting}</h2><p>Now that we have setup:</p><ul><li>CI based on the supported platforms such as Linux</li><li>linting and code quality checks</li><li>code documentation</li></ul><p>... let's discuss how we can properly distribute the package to others.</p><h3>SwiftPM</h3><p>While Swift packages can easily be added simply as a few lines in a</p><p><code>Package.swift</code>, discoverability can be difficult. Luckily thanks to the work of Dave Verwer, the community has a great site with <strong><a href="http://swiftpm.co">swiftpm.co</a></strong>.</p><p>However there are some checks we should add to make sure your Swift package is valid. Additionally we can add these checks to the Swift package continuous integration.</p><h4>Using <code>jq</code> to Verify Products</h4><p>With this intention, we need to make sure that our swift package has at least one valid product. For instance, under the product section of my</p><p><code>Package.swift</code> for my package <strong><a href="https://github.com/brightdigit/AssetLib">AssetLib</a></strong>, it has a library product listed:</p><pre><code>...
  products: [
    <span class="comment">// Products define the executables and libraries produced by a package, and make them visible to other packages.</span>
    .<span class="call">library</span>(
      name: <span class="string">"AssetLib"</span>,
      targets: [<span class="string">"AssetLib"</span>]
    )
  ],
...
</code></pre><p>Fortunately, we can automate this by dumping the JSON of the package and verifying the products listed using <strong><a href="https://stedolan.github.io/jq/">jq</a></strong>. <strong><a href="https://stedolan.github.io/jq/">jq</a></strong> is a fantastic command-line tool for processing JSON data similar to <em>sed</em>. Therefore by piping the JSON from the swift subcommand <code>package dump-package</code> to <code>jq</code>, we can check the number products:</p><pre><code>swift package dump-package | jq -e <span class="string">".products | length &gt; 0"</span>
</code></pre><p>As can be seen, we are using the filter string to check the <code>length</code> property of the property <code>products</code> to see if there is more than one product.</p><p>Lastly, we can submit our Swift package for review by:</p><ul><li>Forking <strong><a href="https://github.com/daveverwer/SwiftPMLibrary">the Repo</a></strong></li><li>Adding our repos to <code>packages.json</code></li><li>Making sure <code>packages.json</code> is sorted via <code>jq</code> by running:<br> <code>echo "$(jq 'sort_by(ascii_downcase)' packages.json)" &gt; packages.json</code></li><li>Run <code>validate.sh</code></li><li>Create a pull request in GitHub</li></ul><p>Then wait for acceptance to see your package listed at <strong><a href="http://swiftpm.co">swiftpm.co</a></strong>.</p><h3>Cocoapods Compatibility</h3><p>While Swift packages are the future of dependency management, there are several reasons why <strong><a href="https://cocoapods.org">Cocoapods</a></strong> is still in use. For this reason, it's a good idea to add support for <strong><a href="https://cocoapods.org">Cocoapods</a></strong> to your library. Luckily, there are only a few simple steps to add for making our Swift package is compatible.</p><p>Once you have <strong><a href="https://cocoapods.org">Cocoapods</a></strong> installed, create the <strong><a href="https://cocoapods.org">Cocoapods</a></strong> spec by running:</p><pre><code>pod spec create $(git remote <span class="keyword">get</span>-url origin)
</code></pre><p>At the present time, you should have a <code>.podspec</code> file named after your library. Inside the <code>.podspec.</code> file, add or set:</p><ul><li>Long description under <code>spec.description</code></li><li>Short summary under <code>spec.summary</code></li><li><a href="https://help.github.com/en/github/building-a-strong-community/adding-a-license-to-a-repository">Create License File</a> and set the set license type and file name under <code>spec.license</code></li><li>Your name and email address under <code>spec.author</code></li><li><a href="https://guides.cocoapods.org/syntax/podspec.html#deployment_target">The deployment targets for each operating system</a></li><li>The <code>spec.source</code> to the repository url and git tag of the target version</li><li><code>spec.source_files</code> to <code>Sources/**/*.swift</code></li><li>The <code>spec.swift_versions</code></li></ul><p>Lastly we can verify our package is valid in our existing continuous integration by including <code>pod lib lint</code> within the macOS sections of our script.</p><h4>Setting Up An Example Project</h4><p>Additionally I would encourage creating an example project using your library with targets in each operating system. Moreover, we can also verify our example project builds. After creating the example project in a directory called Example, create a Podfile using <code>pod init</code>. Then update the <code>Podfile</code> by adding a reference to your pod in the parent directory:</p><pre><code>...
target 'iOS <span class="type">Example</span>' <span class="keyword">do</span>
  # <span class="type">Comment</span> the next line <span class="keyword">if</span> you don't want to use <span class="keyword">dynamic</span> frameworks
  use_frameworks!
  pod '<span class="type">PackageName</span>', :path =&gt; '../'

  # <span class="type">Pods</span> <span class="keyword">for</span> iOS <span class="type">Example</span>

end
...
</code></pre><p>Next to verify the build in our macOS continuous integration, include the following lines:</p><pre><code><span class="keyword">if</span> [[ $TRAVIS_OS_NAME = 'osx' ]]; then
...
  swift package generate-xcodeproj
  pod install --silent --project-directory=<span class="type">Example</span>
  xcodebuild -quiet -workspace <span class="type">Example</span>/<span class="type">Example</span>.<span class="property">xcworkspace</span> -scheme <span class="string">"iOS Example"</span>  <span class="type">ONLY_ACTIVE_ARCH</span>=<span class="type">NO  CODE_SIGN_IDENTITY</span>=<span class="string">""</span> <span class="type">CODE_SIGNING_REQUIRED</span>=<span class="type">NO  CODE_SIGNING_ALLOWED</span>=<span class="type">NO</span>
  xcodebuild -quiet -workspace <span class="type">Example</span>/<span class="type">Example</span>.<span class="property">xcworkspace</span> -scheme <span class="string">"tvOS Example"</span>  <span class="type">ONLY_ACTIVE_ARCH</span>=<span class="type">NO   CODE_SIGN_IDENTITY</span>=<span class="string">""</span> <span class="type">CODE_SIGNING_REQUIRED</span>=<span class="type">NO  CODE_SIGNING_ALLOWED</span>=<span class="type">NO</span>
  xcodebuild -quiet -workspace <span class="type">Example</span>/<span class="type">Example</span>.<span class="property">xcworkspace</span> -scheme <span class="string">"macOS Example"</span>  <span class="type">ONLY_ACTIVE_ARCH</span>=<span class="type">NO CODE_SIGN_IDENTITY</span>=<span class="string">""</span> <span class="type">CODE_SIGNING_REQUIRED</span>=<span class="type">NO  CODE_SIGNING_ALLOWED</span>=<span class="type">NO</span>
...
</code></pre><p>In other words, this script example for Travis-CI, will:</p><ul><li>Generate the Xcode project <strong><a href="https://cocoapods.org">Cocoapods</a></strong> needs.</li><li>Install the <strong><a href="https://cocoapods.org">Cocoapod</a></strong> and create the workspace file</li><li>Build each application target for each operating system</li></ul><p>Therefore, we have created a <code>.podspec</code> and added continuous integration for the pod as well as the example project. Lastly, we need to push the repository to GitHub and tag it with the proper version. Once that's done, make sure you have a <strong><a href="https://cocoapods.org">Cocoapods</a></strong> account setup and run: <code>pod trunk push NAME.podspec</code> to push our repo.</p><h2>Examples and Integration {#examples-integration}</h2><p>In the end, it's important to make sure your package maintains good quality, works on its designated platforms, is easily available, and is fully tested. If you are interested, you can check out packages which I have implemented using these practices:</p><ul><li><strong><a href="https://github.com/brightdigit/Base32Crockford">Base32Crockford</a></strong> - the Swift implementation ofÂ <a href="https://www.crockford.com/base32.html">the Base32Crockford encoding</a></li><li><strong><a href="https://github.com/brightdigit/AssetLib">AssetLib</a></strong> - which reads and updates app icon and image set information used in Xcode Asset Libraries</li><li><strong><a href="https://github.com/brightdigit/swiftver">SwiftVer</a></strong> - reads version information from Bundles and Plists as well as information stored from version control usingÂ <a href="https://autorevision.github.io/">autorevision</a></li></ul><p>Furthermore, you can use my GitHub template <strong><a href="https://github.com/brightdigit/EggSeed">EggSeed</a></strong>, which automates most of what we've talked about here:</p><ul><li>creation of a Swift package library</li><li>creation of Cocoapod spec</li><li>setup of example projects</li><li>SwiftLint and SwiftFormat tooling</li><li>code documentation setup</li><li>CI Integration with Travis-CI, GitHub Actions, and CodeCov.IO</li></ul><p>Additionally, badges are included from <strong><a href="https://shields.io">shields.io</a></strong> to showcase the quality of your Swift package continuous integration.</p><p>Feel free to reach out if you have any additional questions <a href="https://twitter.com/leogdion">on Twitter <strong>@leogdion</strong></a>{#signup} or signup for the newsletter below to get the latest tutorials and guides on Swift development.</p></div>
        <span>Tagged with: </span>
      </article>
    </main>
    <footer>
      <div class="address">5859 W Saginaw #182 Lansing MI 48917</div>
      <div class="copyright">Â© Bright Digit, LLC 2021</div>
    </footer>
  </body>
</html>