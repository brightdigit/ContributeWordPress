<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="/css/styles.css"/>
  </head>
  <body>
    <header>
      <nav>
        <ol class="logo">
          <li>
            <a href="/">
              <img src="/media/brightdigit-name.svg"/>
            </a>
          </li>
        </ol>
        <ol class="menu">
          <li>
            <a href="/services">Services</a>
          </li>
          <li>
            <a href="/products">Products</a>
          </li>
          <li>
            <a href="/articles">Articles</a>
          </li>
          <li>
            <a href="/development">Development</a>
          </li>
        </ol>
        <ol class="menu">
          <li>
            <a href="/podcast">Podcast</a>
          </li>
          <li>
            <a href="/newsletters">Newsletters</a>
          </li>
          <li>
            <a href="/sponsorship">Sponsorship</a>
          </li>
          <li>
            <a href="/about">About</a>
          </li>
        </ol>
        <ol class="more">
          <li>
            <a href="/#menu">Menu</a>
          </li>
        </ol>
      </nav>
    </header>
    <main>
      <article>
        <div class="content"><p>In the development of my latest app which is an Independent Watch App that uses <a href="https://learningswift.brightdigit.com/healthkit-getting-started/">HealthKit</a>, I ran into an issue with App Store Connect. <strong>App Store Connect will complain about missing</strong> <strong><em>Purpose Strings</em></strong><strong>, that is the messages display to the user when access permission is asked for health information.</strong></p><blockquote><p><strong>ITMS-90683: Missing Purpose String in Info.plist</strong> - Your app's code references one or more APIs that access sensitive user data. The app's Info.plist file should contain a NSHealthShareUsageDescription key with a user-facing purpose string explaining clearly and completely why your app needs the data. Starting Spring 2019, all apps submitted to the App Store that access user data are required to include a purpose string. If you're using external libraries or SDKs, they may reference APIs that require a purpose string. While your app might not use these APIs, a purpose string is still required. You can contact the developer of the library or SDK and request they release a version of their code that doesn't contain the APIs. Learn more (<a href="https://developer.apple.com/documentation/uikit/core_app/protecting_the_user_s_privacy">https://developer.apple.com/d<br>&gt; ocumentation/uikit/core<em>app/protecting</em>the<em>user</em>s_privacy</a>). <br>&gt; <strong>ITMS-90683: Missing Purpose String in Info.plist</strong> - Your app's code references one or more APIs that access sensitive user data. The app's Info.plist file should contain a NSHealthUpdateUsageDescriptio<br>&gt; n key with a user-facing purpose string explaining clearly and completely why your app needs the data. Starting Spring 2019, all apps submitted to the App Store that access user data are required to include a purpose string. If you're using external libraries or SDKs, they may reference APIs that require a purpose string. While your app might not use these APIs, a purpose string is still required. You can contact the developer of the library or SDK and request they release a version of their code that doesn't contain the APIs. Learn more (<a href="https://developer.apple.com/documentation/uikit/core_app/protecting_the_user_s_privacy">https://developer.apple.com/d<br>&gt; ocumentation/uikit/core<em>app/protecting</em>the<em>user</em>s_privacy</a>).</p></blockquote><p>This is regardless of whether the Property List in the Watch App Extension includes these properties.</p><h2>The Resolution</h2><p>To resolve this issue, create a new <em>Property List</em> <strong>with no target set</strong> in your project at the root:</p><img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2019/09/Screen-Shot-2019-09-17-at-2.25.49-PM.png"/><p>{.wp-image-667}</p><p>Inside that <em>Property List</em> add (or copy) the required <em>HealthKit Property Strings</em> to your new <em>Property List</em> file.</p><img src="https://learningswift.brightdigit.com/wp-content/uploads/sites/2/2019/09/Screen-Shot-2019-09-17-at-2.27.48-PM.png"/><p>{.wp-image-668}</p><p>In short, these properties should be the only required properties in your file. Lastly, set this <em>Property List</em> file as the property list file of your app container target:</p><ol><li>Click on the Project File in the Navigator on the right.</li><li>Select the <em>App Container</em> target.<br> *This should be obvious since the target does not come with a Property List file on initial creation in Xcode.*</li><li>Go to the <strong>Build Setting</strong> tab on the top.</li><li>Search for <strong>Info.plist File</strong></li><li>In the field value enter the name of the newly created Info.plist file with your HealthKit Privacy strings set.</li></ol><img src="https://i1.wp.com/learningswift.brightdigit.com/wp-content/uploads/sites/2/2019/09/Screen-Shot-2019-09-17-at-2.32.21-PM.png?fit=640%2C325&ssl=1"/><p>{.wp-image-669}</p><p>Now go ahead and archive and distribute your app to App Store Connect from the organizer as usual. App Store should be happy moving forward.</p><h2>In Summary...</h2><ul><li>App Store Connect requires both your Apple Watch App Extension and your App Watch App Container to contain an Info.plist file with NSHealthUpdateUsageDescription and NSHealthShareUsageDescription strings set.</li><li>To fix this, create a new Info.plist file with those settings set for your App Container.</li><li>The new Info.plist is not to be included in your App Container but rather set as your App Container's Info.plist file in Build Settings.</li></ul><p>Perhaps this will be fixed in the Independent Apple Watch App template in the future or in App Store Connect but for now you can easily publish your Independent Watch App to the TestFlight and the App Store.</p></div>
        <span>Tagged with: </span>
      </article>
    </main>
    <footer>
      <div class="address">5859 W Saginaw #182 Lansing MI 48917</div>
      <div class="copyright">© Bright Digit, LLC 2021</div>
    </footer>
  </body>
</html>